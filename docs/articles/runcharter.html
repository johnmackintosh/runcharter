<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>runcharter • runcharter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="runcharter">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">runcharter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/runcharter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/johnmackintosh/runcharter">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>runcharter</h1>
                        <h4 class="author">John MacKintosh</h4>
            
            <h4 class="date">2019-09-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/johnmackintosh/runcharter/blob/master/vignettes/runcharter.Rmd"><code>vignettes/runcharter.Rmd</code></a></small>
      <div class="hidden name"><code>runcharter.Rmd</code></div>

    </div>

    
    
<div id="rationale" class="section level2">
<h2 class="hasAnchor">
<a href="#rationale" class="anchor"></a>Rationale</h2>
<p>Run charts are easy to create and analyse on an individual basis, hence they are widely used in healthcare quality improvement.</p>
<p>A run chart is a regular line chart, with a central reference line.</p>
<p>This central line, calculated using the median of a number of values over a baseline period, allows the QI team to assess if any statistically significant improvement is taking place, as a result of their improvement initiatives.</p>
<p>These improvements are denoted by certain patterns, or signals, within the plotted data points, in relation to the median line. The main signal is a run of 9 or more consecutive values on the desired side of the median line.</p>
<p>If this signal occurs as a result of improvement activities, but performance is not yet at the target level, a new median line can be plotted.</p>
<p>This is calculated using the median of the points that contributed to the signal. The aim is to then continue to work on improvement, measure and plot data, and look for the next sustained signal, until the improvement initiative is operating at its target level.</p>
<p>While this ‘rebasing’ (calculating new medians) is manageable for a few charts, it quickly becomes labour intensive as QI initiatives expand or further QI programmes are launched.</p>
<p>While enterprise level database software can be used to store the raw data, their associated reporting systems are usually ill suited to the task of analysing QI data using run chart rules.</p>
<p>This package automatically creates rebased run charts, based on the run chart rule for sustained improvement commonly used in healthcare ( 9 consecutive points on the desired side of the median).</p>
<p>All sustained runs of improvement, in the desired direction, will be highlighted and the median re-phased, using the points that contributed to the run.</p>
<p>Non useful observations (points on the median) are ignored and are not highlighted.</p>
<p>The main motivation is to analyse many charts at once, but you can also create and analyse a single run chart, or iterate, plot and save many individual charts.</p>
</div>
<div id="the-runcharter-function---input" class="section level2">
<h2 class="hasAnchor">
<a href="#the-runcharter-function---input" class="anchor"></a>The runcharter function - input</h2>
<p>The function requires a simple three column dataframe, with the following column names:</p>
<ul>
<li>datecol : a column, typically of type ‘date’, but can be an integer representing individual patient IDs (for example).</li>
<li>grpvar : a character column indicating a grouping variable to identify each individual run chart and for faceted plots. Factors will be converted to character.</li>
<li>yval : the variable / value to plot.</li>
</ul>
</div>
<div id="dataframe-or-data-table-and-use-of-the-pipe" class="section level2">
<h2 class="hasAnchor">
<a href="#dataframe-or-data-table-and-use-of-the-pipe" class="anchor"></a>Dataframe or data.table and use of the pipe</h2>
<p>You can pass a dataframe, tibble or data.table to the function. It will be converted to data.table. You do not need to know data.table to use this package. The magrittr pipe is exported, so you can continue to use dplyr style syntax for data manipulation prior to using the function</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Loading required package: data.table</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">testdf &lt;-<span class="st"> </span>signals <span class="co"># rename the built in data set</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(testdf) <span class="co"># note class of tibble, tbl_df and dataframe</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">testdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(</a>
<a class="sourceLine" id="cb1-10" title="10">           <span class="dt">direction =</span> <span class="st">"both"</span>,</a>
<a class="sourceLine" id="cb1-11" title="11">           <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb1-12" title="12">           <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb1-13" title="13">           <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb1-14" title="14">           <span class="dt">facet_cols =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/pipe-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to  run_type
#&gt; 1: WardV      7 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 2: WardX     11 2014-01-01 2015-01-01 2016-12-01  baseline
#&gt; 3: WardY     13 2014-01-01 2015-01-01 2017-10-01  baseline
#&gt; 4: WardZ      4 2014-01-01 2015-01-01 2017-06-01  baseline
#&gt; 5: WardX      6 2016-12-01 2017-08-01 2018-07-01 sustained
#&gt; 6: WardY      8 2017-10-01 2018-06-01 2018-07-01 sustained
#&gt; 7: WardZ      9 2017-06-01 2018-03-01 2018-07-01 sustained

# results class data.table</code></pre>
</div>
<div id="runcharter-function-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#runcharter-function-arguments" class="anchor"></a>runcharter function arguments</h2>
<ul>
<li><p>df : a three column dataframe or data table with columns specifying a grouping variable -‘grpvar’, a date column -‘datecol’ and ‘yvar’ as the value to plot on the y axis. The grouping variable should be a character column, however if a factor column is passed to the function it will be converted to character. Data frames will be converted to data.table</p></li>
<li><p>med_rows : How many rows / data points should the initial baseline median be calculated over?</p></li>
<li><p>runlength : How long a run of consecutive points do you want to find, before you rebase the median? The median will be rebased using all useful observations (points on the median are not useful, and are ignored).</p></li>
<li><p>direction : “above” or “below” the median, or “both”. Use “both” if you want to rebase the run chart any time a run of the desired length occurs, even if it is on the “wrong” side of the median line.</p></li>
<li><p>datecol : the name of the date column. If you are plotting individual observations in time order, you can also supply an ID value instead of a date.</p></li>
<li><p>grpvar : a character vector specifying the grouping variable used to facet the plots. Ordered factors will be converted to character during processing, and back to ordered factor prior to plotting.</p></li>
<li><p>yval : a numeric column to be plotted on the y-axis. Integers will be converted to numeric</p></li>
<li><p>facet_cols : the number of columns in the final faceted plot</p></li>
<li><p>chart_title : The main title for the chart</p></li>
<li><p>chart_subtitle : A subtitle for the chart</p></li>
<li><p>chart_caption : A caption for the chart</p></li>
<li><p>chart_breaks : character string defining desired x-axis date breaks e.g. “3 months”. Will be ignored if ‘datecol’ is an integer instead of a date value.</p></li>
<li><p>line_colr : Colour for run chart lines</p></li>
<li><p>point_colr : Colour for run chart points</p></li>
<li><p>median_colr : Colour for solid and extended median lines</p></li>
<li><p>highlight_fill : Fill colour to highlight points in a sustained run</p></li>
<li><p>… : further arguments passed on to function</p></li>
</ul>
<p>The package exports the magrittr pipe, so you can chain commands using data.table syntax, or alternatively, use dplyr syntax and chain to the runcharter function</p>
</div>
<div id="function-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#function-outputs" class="anchor"></a>Function outputs</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(signals ,<span class="dt">med_rows =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="dt">runlength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="dt">direction =</span> <span class="st">"below"</span>,</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="dt">grpvar =</span> <span class="st">"grp"</span>,</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="dt">chart_title =</span> <span class="st">"Analysis of runs below median"</span>,</a>
<a class="sourceLine" id="cb3-9" title="9"><span class="dt">chart_subtitle =</span> <span class="st">"Example plot"</span>,</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="dt">chart_caption =</span> <span class="st">"analysed with runcharter"</span>,</a>
<a class="sourceLine" id="cb3-11" title="11"><span class="dt">chart_breaks =</span> <span class="st">"6 months"</span>)</a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/run-below-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to  run_type
#&gt; 1: WardV      7 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 2: WardX     11 2014-01-01 2015-01-01 2016-12-01  baseline
#&gt; 3: WardY     13 2014-01-01 2015-01-01 2017-10-01  baseline
#&gt; 4: WardZ      4 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 5: WardX      6 2016-12-01 2017-08-01 2018-07-01 sustained
#&gt; 6: WardY      8 2017-10-01 2018-06-01 2018-07-01 sustained</code></pre>
</div>
<div id="plot-explanation" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-explanation" class="anchor"></a>Plot explanation</h2>
<ul>
<li><p><code>med_rows</code> defines the initial baseline period. In the example below, the first 13 points are used to calculate the initial median. This is represented with a solid orange horizontal line. This median is then used as a reference for the remaining values, denoted by the extending orange dashed line</p></li>
<li><p><code>runlength</code> specifies the length of run to be identified. Along with <code>direction</code>, which specifies which side of median represents improvement, the runlength is your target number of successive points on the desired side of the median (points on the median are ignored as they do not make or break a run). You can set the <code>direction</code> as either “above” or “below” the line, to evidence improvement in a specific direction. Searching for runs in “both” directions is also possible. This might be more applicable for long term monitoring, rather than improvement purposes.</p></li>
</ul>
<p>If a run is identified, the points are highlighted (the purple coloured points), and a new median is calculated using them. The median is also plotted and extended into the future for further run chart rules analysis, with a new set of solid and dashed horizontal lines.</p>
<p>The analysis continues, rebasing any further runs, until no more runs are found or there are not enough data points remaining.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(signals,</a>
<a class="sourceLine" id="cb5-3" title="3">           <span class="dt">direction =</span> <span class="st">"above"</span>,</a>
<a class="sourceLine" id="cb5-4" title="4">           <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb5-5" title="5">           <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb5-6" title="6">           <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb5-7" title="7">           <span class="dt">facet_cols =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/runs-above-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to  run_type
#&gt; 1: WardV      7 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 2: WardX     11 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 3: WardY     13 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 4: WardZ      4 2014-01-01 2015-01-01 2017-06-01  baseline
#&gt; 5: WardZ      9 2017-06-01 2018-03-01 2018-07-01 sustained</code></pre>
</div>
<div id="find-runs-in-both-directions" class="section level2">
<h2 class="hasAnchor">
<a href="#find-runs-in-both-directions" class="anchor"></a>Find runs in both directions</h2>
<p>Typically, you would only look for runs either “above” or “below” the median, depending on the nature of the metric you are studying and what determines an improvement (e.g. below the median for reduced admissions and above the median for increased care bundle compliance). You can also look for any run, occuring on either side of the median, by specifying “both” as the direction.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb7-2" title="2">signals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(</a>
<a class="sourceLine" id="cb7-3" title="3">           <span class="dt">direction =</span> <span class="st">"both"</span>,</a>
<a class="sourceLine" id="cb7-4" title="4">           <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb7-5" title="5">           <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb7-6" title="6">           <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb7-7" title="7">           <span class="dt">facet_cols =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/both-directions-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to  run_type
#&gt; 1: WardV      7 2014-01-01 2015-01-01 2018-07-01  baseline
#&gt; 2: WardX     11 2014-01-01 2015-01-01 2016-12-01  baseline
#&gt; 3: WardY     13 2014-01-01 2015-01-01 2017-10-01  baseline
#&gt; 4: WardZ      4 2014-01-01 2015-01-01 2017-06-01  baseline
#&gt; 5: WardX      6 2016-12-01 2017-08-01 2018-07-01 sustained
#&gt; 6: WardY      8 2017-10-01 2018-06-01 2018-07-01 sustained
#&gt; 7: WardZ      9 2017-06-01 2018-03-01 2018-07-01 sustained</code></pre>
<p>Note that runs below the median are found for Wards X and Y, while a run above the median is highlighted for Ward Z.</p>
<p>The function will print the plot, and return a list, containing:</p>
<ul>
<li>the plot as a ggplot2 object,<br>
</li>
<li>a datatable summarising the baseline median and each sustained period of improvement.</li>
</ul>
<p>Don’t try this at home - setting runlength of 5 and searching in both directions to confirm that successive runs are identified. A run of 5 would not be a statistically significant shift in real life - the package defaults to 9 as the desired run length.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">signals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(<span class="dt">med_rows =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">             <span class="dt">runlength =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb9-4" title="4">             <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">              <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb9-6" title="6">              <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">             <span class="dt">direction =</span> <span class="st">"both"</span>)</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/multiple-runs-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;       grp median start_date   end_date  extend_to  run_type
#&gt;  1: WardV      5 2014-01-01 2014-07-01 2015-01-01  baseline
#&gt;  2: WardX     11 2014-01-01 2014-07-01 2014-11-01  baseline
#&gt;  3: WardY     14 2014-01-01 2014-07-01 2014-12-01  baseline
#&gt;  4: WardZ      4 2014-01-01 2014-07-01 2015-01-01  baseline
#&gt;  5: WardV     15 2015-01-01 2015-05-01 2015-10-01 sustained
#&gt;  6: WardX      7 2014-11-01 2015-03-01 2015-04-01 sustained
#&gt;  7: WardY     19 2014-12-01 2015-04-01 2015-06-01 sustained
#&gt;  8: WardZ      7 2015-01-01 2015-05-01 2015-12-01 sustained
#&gt;  9: WardV     11 2015-10-01 2016-02-01 2018-07-01 sustained
#&gt; 10: WardX     11 2015-04-01 2015-08-01 2016-12-01 sustained
#&gt; 11: WardY     15 2015-06-01 2015-10-01 2017-10-01 sustained
#&gt; 12: WardZ      4 2015-12-01 2016-04-01 2017-06-01 sustained
#&gt; 13: WardX      5 2016-12-01 2017-04-01 2018-02-01 sustained
#&gt; 14: WardY      7 2017-10-01 2018-02-01 2018-07-01 sustained
#&gt; 15: WardZ      9 2017-06-01 2017-10-01 2018-07-01 sustained
#&gt; 16: WardX      7 2018-02-01 2018-06-01 2018-07-01 sustained</code></pre>
</div>
<div id="factors-instead-of-character-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#factors-instead-of-character-groups" class="anchor"></a>Factors instead of character groups</h2>
<p>Factors can cause problems, so they are converted to character prior to processing. However, they are converted back prior to plotting, so that individual facets appear in the correct order.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(NHSRdatasets)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4">LOSdata &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">copy</span>(LOS_model)</a>
<a class="sourceLine" id="cb11-5" title="5">utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(LOSdata) <span class="co"># note that Organisation is an ordered factor, not character</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; 'data.frame':    300 obs. of  5 variables:</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt;  $ ID          : int  1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#&gt;  $ Organisation: Ord.factor w/ 10 levels "Trust1"&lt;"Trust2"&lt;..: 1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co">#&gt;  $ Age         : int  55 27 93 45 70 60 25 48 51 81 ...</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;  $ LOS         : int  2 1 12 3 11 7 4 4 7 1 ...</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt;  $ Death       : int  0 0 0 1 0 0 0 0 1 0 ...</span></a>
<a class="sourceLine" id="cb11-12" title="12"></a>
<a class="sourceLine" id="cb11-13" title="13">LOSdata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(<span class="dt">med_rows =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb11-14" title="14">                   <span class="dt">runlength =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb11-15" title="15">                   <span class="dt">direction =</span> <span class="st">"both"</span>,</a>
<a class="sourceLine" id="cb11-16" title="16">                   <span class="dt">datecol =</span> <span class="st">"ID"</span>,</a>
<a class="sourceLine" id="cb11-17" title="17">                   <span class="dt">grpvar =</span> <span class="st">"Organisation"</span>,</a>
<a class="sourceLine" id="cb11-18" title="18">                   <span class="dt">yval =</span> <span class="st">"LOS"</span>)</a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/factor-handling-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;     Organisation median start_date end_date extend_to  run_type
#&gt;  1:       Trust1      7          1       81       171  baseline
#&gt;  2:      Trust10      3         10       90       300  baseline
#&gt;  3:       Trust2      2          2       82       202  baseline
#&gt;  4:       Trust3      5          3       83       300  baseline
#&gt;  5:       Trust4      4          4       84       300  baseline
#&gt;  6:       Trust5      7          5       85       300  baseline
#&gt;  7:       Trust6      7          6       86       300  baseline
#&gt;  8:       Trust7      3          7       87       300  baseline
#&gt;  9:       Trust8      4          8       88       300  baseline
#&gt; 10:       Trust9      3          9       89       300  baseline
#&gt; 11:       Trust1      3        171      251       300 sustained
#&gt; 12:       Trust2      4        202      292       300 sustained</code></pre>
</div>
<div id="turn-off-run-chart-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#turn-off-run-chart-analysis" class="anchor"></a>Turn off run chart analysis</h2>
<p>You can avoid rebasing medians by setting ‘runlength’ to 0 (zero). This will plot the runcharts with the original baseline medians, but no runs analysis will take place.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb13-2" title="2">signals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(<span class="dt">med_rows =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb13-4" title="4">             <span class="dt">runlength =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb13-5" title="5">             <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb13-6" title="6">              <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb13-7" title="7">              <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb13-8" title="8">             <span class="dt">direction =</span> <span class="st">"both"</span>)</a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/analysis_off-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to run_type
#&gt; 1: WardV      7 2014-01-01 2015-01-01 2018-07-01 baseline
#&gt; 2: WardX     11 2014-01-01 2015-01-01 2018-07-01 baseline
#&gt; 3: WardY     13 2014-01-01 2015-01-01 2018-07-01 baseline
#&gt; 4: WardZ      4 2014-01-01 2015-01-01 2018-07-01 baseline</code></pre>
<p>Similarly, you can plot basic line charts by setting ‘med_rows’ to 0 (zero)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(runcharter)</a>
<a class="sourceLine" id="cb15-2" title="2">signals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/runcharter.html">runcharter</a></span>(<span class="dt">med_rows =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb15-4" title="4">             <span class="dt">runlength =</span> <span class="dv">9</span>, </a>
<a class="sourceLine" id="cb15-5" title="5">             <span class="dt">datecol =</span> <span class="st">"date"</span>,</a>
<a class="sourceLine" id="cb15-6" title="6">              <span class="dt">grpvar =</span> <span class="st">"grp"</span>, </a>
<a class="sourceLine" id="cb15-7" title="7">              <span class="dt">yval =</span> <span class="st">"y"</span>,</a>
<a class="sourceLine" id="cb15-8" title="8">             <span class="dt">direction =</span> <span class="st">"both"</span>)</a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt; $runchart</span></a></code></pre></div>
<p><img src="man/figures/med_row-0-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $sustained
#&gt;      grp median start_date   end_date  extend_to run_type
#&gt; 1: WardV     NA 2014-01-01 2014-01-01 2018-07-01 baseline
#&gt; 2: WardX     NA 2014-01-01 2014-01-01 2018-07-01 baseline
#&gt; 3: WardY     NA 2014-01-01 2014-01-01 2018-07-01 baseline
#&gt; 4: WardZ     NA 2014-01-01 2014-01-01 2018-07-01 baseline</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#rationale">Rationale</a></li>
      <li><a href="#the-runcharter-function---input">The runcharter function - input</a></li>
      <li><a href="#dataframe-or-data-table-and-use-of-the-pipe">Dataframe or data.table and use of the pipe</a></li>
      <li><a href="#runcharter-function-arguments">runcharter function arguments</a></li>
      <li><a href="#function-outputs">Function outputs</a></li>
      <li><a href="#plot-explanation">Plot explanation</a></li>
      <li><a href="#find-runs-in-both-directions">Find runs in both directions</a></li>
      <li><a href="#factors-instead-of-character-groups">Factors instead of character groups</a></li>
      <li><a href="#turn-off-run-chart-analysis">Turn off run chart analysis</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John MacKintosh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
